import{S as o}from"./Supercluster-ZPpcK6BM.js";import{n,V as c}from"./app-DyDI7BAJ.js";import{v as l}from"./vue2Dropzone-BHGT8B80.js";import"./index-Dxbj43yt.js";import"./mapHelpers-DpOuDyZu.js";import"./moment-zH0z38ay.js";import"./glify-browser-BviNXcn7.js";/* empty css            */const m={name:"MerchantMap",components:{Supercluster:o},data(){return{loading:!1}},async created(){this.loading=!0,await this.$store.dispatch("GET_MERCHANTS_GEOJSON"),this.loading=!1}};var p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"h100"},[e.loading?t("div"):t("Supercluster",{attrs:{activeLayer:"merchants"}})],1)},h=[],d=n(m,p,h,!1,null,"d1448ca1");const u=d.exports,_={name:"CreateMerchant",components:{vueDropzone:l},data(){return{name:"",address:"",email:"",website:"",about:"",processing:!1,merchantWasCreated:!1,dropzoneOptions:{url:"/merchants/upload-photo",thumbnailWidth:150,maxFilesize:20,headers:{"X-CSRF-TOKEN":window.axios.defaults.headers.common["X-CSRF-TOKEN"]},paramName:"file",acceptedFiles:"image/*,.heic,.heif",params:{merchantId:0}}}},computed:{merchant(){return this.$store.state.merchants.merchant}},methods:{async submit(){if(this.merchant.lat===0&&this.merchant.lon===0){alert("Please select a location");return}if(this.name===""||this.email===""||this.website===""||this.about===""){alert("Please enter something into all fields");return}this.processing=!0,await this.$store.dispatch("CREATE_MERCHANT",{name:this.name,lat:this.merchant.lat,lon:this.merchant.lon,email:this.email,about:this.about,website:this.website}),this.name="",this.email="",this.about="",this.website="",this.merchantWasCreated=!0,this.dropzoneOptions.params.merchantId=this.merchant.id,this.processing=!1},failed(s,e){const t=e.message,a=s.previewElement.querySelector(".dz-error-message");a&&(a.textContent=t,a.style.opacity=1,a.style.pointerEvents="auto");const r=this.$t("notifications.error"),i=e.message;c.$vToastify.error({title:r,body:i,position:"top-right",type:"error"})}}};var v=function(){var e=this,t=e._self._c;return t("div",[t("p",{staticClass:"title is-1"},[e._v(" "+e._s(this.merchantWasCreated?"Upload photos":"Create a Merchant!")+" ")]),e.merchantWasCreated?t("vue-dropzone",{attrs:{id:"dropzone",options:e.dropzoneOptions,"use-custom-slot":!0},on:{"vdropzone-error":e.failed}},[t("i",{staticClass:"fa fa-image upload-icon",attrs:{"aria-hidden":"true"}})]):t("div",[t("p",{staticClass:"merchant-label"},[e._v("Name")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"input w50 merchant-input",attrs:{placeholder:"Name of the business"},domProps:{value:e.name},on:{input:function(a){a.target.composing||(e.name=a.target.value)}}}),t("div",{staticClass:"mb1"},[e.merchant.lat?t("div",[t("p",[e._v(" Lat: "+e._s(e.merchant.lat)+" ")]),t("p",[e._v(" Lon: "+e._s(e.merchant.lon)+" ")])]):t("p",[e._v(" Click anywhere on the map to set the location ")])]),t("p",{staticClass:"merchant-label"},[e._v("Email")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input w50 merchant-input",attrs:{placeholder:"Enter their email",type:"email"},domProps:{value:e.email},on:{input:function(a){a.target.composing||(e.email=a.target.value)}}}),t("p",{staticClass:"merchant-label"},[e._v("Website")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.website,expression:"website"}],staticClass:"input w50 merchant-input",attrs:{placeholder:"https://website.com"},domProps:{value:e.website},on:{input:function(a){a.target.composing||(e.website=a.target.value)}}}),t("p",{staticClass:"merchant-label"},[e._v("About")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.about,expression:"about"}],staticClass:"input w50 merchant-input",staticStyle:{"margin-bottom":"2em"},attrs:{placeholder:"Information or keywords"},domProps:{value:e.about},on:{input:function(a){a.target.composing||(e.about=a.target.value)}}}),t("br"),t("button",{staticClass:"button is-medium is-primary",class:e.processing?"is-loading":"",attrs:{disabled:e.processing},on:{click:e.submit}},[e._v(" Create ")])])],1)},f=[],b=n(_,v,f,!1,null,"3385c883");const g=b.exports,C={name:"ApproveMerchant",data(){return{processing:!1,processingDelete:!1,loading:!0}},async created(){this.loading=!0,await this.$store.dispatch("GET_NEXT_MERCHANT_TO_APPROVE"),this.loading=!1},computed:{merchant(){return this.$store.state.merchants.merchant}},methods:{async approveMerchant(){this.processing=!0,await this.$store.dispatch("APPROVE_MERCHANT"),this.processing=!1},async deleteMerchant(){this.processingDelete=!0,await this.$store.dispatch("DELETE_MERCHANT"),this.processingDelete=!1}}};var w=function(){var e=this,t=e._self._c;return t("div",[e.loading?t("p",[e._v("Loading...")]):this.merchant.lat===0&&this.merchant.lon===0?t("p",[e._v("Done - Thank you!")]):t("div",[t("p",[e._v("Name: "+e._s(this.merchant.name))]),t("p",[e._v("About: "+e._s(this.merchant.about))]),t("p",[e._v("Website: "+e._s(this.merchant.website))]),t("div",{staticClass:"flex mt1"},[t("button",{staticClass:"button is-medium is-primary mr1",class:e.processing?"is-loading":"",attrs:{disabled:e.processing},on:{click:e.approveMerchant}},[e._v(" Approve ")]),t("button",{staticClass:"button is-medium is-danger",class:e.processingDelete?"is-loading":"",attrs:{disabled:e.processingDelete},on:{click:e.deleteMerchant}},[e._v(" Delete ")])])])])},M=[],E=n(C,w,M,!1,null,"ae67b4fd");const y=E.exports,$={name:"Merchants",components:{MerchantMap:u,CreateMerchant:g,ApproveMerchant:y},data(){return{selectedComponent:"CreateMerchant"}},methods:{changeComponent(s){this.selectedComponent=s}}};var N=function(){var e=this,t=e._self._c;return t("div",{staticClass:"h100"},[t("div",{staticClass:"columns h100"},[t("div",{staticClass:"column is-half"},[t("MerchantMap")],1),t("div",{staticClass:"column is-half pt5 pl5"},[e.can("approve merchants")?t("div",{staticClass:"mb3"},[t("button",{staticClass:"button is-small is-info",on:{click:function(a){return e.changeComponent("CreateMerchant")}}},[e._v("Create Merchants")]),t("button",{staticClass:"button is-small is-warning",on:{click:function(a){return e.changeComponent("ApproveMerchant")}}},[e._v("Approve Merchants")])]):e._e(),t(e.selectedComponent,{tag:"component"})],1)])])},A=[],T=n($,N,A,!1,null,"becb4ef6");const F=T.exports;export{F as default};
